name: macOS_CI
on:
  push:
    branches:
      - master
      - rel-*
  pull_request:

concurrency:
  group: ${{ github.workflow }}-${{ github.head_ref || github.run_id }}
  cancel-in-progress: true

jobs:
  test:
    runs-on: macos-11
    steps:
      - uses: actions/checkout@v4
        with:
          submodules: true

      - uses: conda-incubator/setup-miniconda@v3
        with:
          activate-environment: test_env
          python-version: 3.9

      - name: 'Inspect environment 1'
        run: |
         conda list
         pip freeze
  
      - name: 'Install pip from PyPI'
        run: |
          python3 -m pip install -U pip

      - name: 'Inspect environment 2'
        run: |
          conda list
          pip freeze

      - name: 'Install onnxruntime==1.17.0 from PyPI'
        run: |
          python3 -m pip install onnxruntime==1.17.0

      - name: 'Inspect environment 3'
        run: |
          conda list
          pip freeze
